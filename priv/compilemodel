#!/usr/bin/env escript
%% -*- erlang -*-
%%! -smp enable -sname compilemodel -pa ebin
main([]) ->
    application:load(erldb),
    {ok, Path} = application:get_env(erldb, model_path),
    io:format("model_path: ~p~n", [Path]),
    erldb_log:msg("Start compiling", ""),
    {ok, Filenames} = file:list_dir(Path),
    compile_models(Filenames, Path),
    erldb_log:msg("Done compiling", "").

compile_models([], _) ->
    ok;
compile_models([H|T], Path) ->
    Result = erldb_compiler:compile(filename:join([Path, H]),
				    [{includedir, "./include"},
				     {outdir, "./ebin"}]),
    io:format("~p... ~p~n", [H, Result]),
    compile_models(T, Path).
